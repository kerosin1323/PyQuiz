{% extends "base.html" %}

{% block content %}
<form action="" method="post" novalidate>
    <p></p>
    <div class="container" style="color:white">
        <div class="read_article" style="box-shadow: 2px 2px 4px 4px rgba(0,0,0,0.2);border: 2px solid #1D2330;padding:10px;background-color: #293245">
        <a style="display:flex; text-decoration: none;" class="first_level" href="/profile/{{article.user_id}}">
            <div class="time">
                {{ time }}
            </div>
            <div class="image">
                <img src="/static/images/{{ user.photo }}" alt="photo" height="50px" width="50px" style="margin-top:5px;margin-bottom:15px;border-radius: 50%">
            </div>
            <div style="margin-top:-15px;margin-left:15px;margin-right:15px" class="creator">
                <div class="creator_name" style="background-color: gray; border-radius: 10px;padding-left:5px;padding-right:5px;margin-top:15px;font-size:20px;color:white" href="/profile/{{article.user_id}}"> {{user.name}}</div>
                <div style="text-decoration:none;color:white;font-size:14px;color:#A8A8A8">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏: {{user.subscribers}}</div>
            </div>
            {% if is_subscribed %}
            <div class="follow">
                <button name="to_subscribe" class="btn btn-secondary" value="1">–û—Ç–ø–∏—Å–∞—Ç—å—Å—è</button>
            </div>
            {% else %}
            <div class="follow">
                <button name="to_subscribe" class="btn btn-danger" value="1">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
            </div>
            {% endif %}
        </a>
        <div class="header">
            <div style="font-size:50px;margin-top:-10px">
                {{ article.name }}
            </div>
        </div>
            {% if article.photo %}
                <div class="image" style="padding:10px">
                    <img src="/static/images/{{ article.photo }}" alt="photo" height="100%" width="100%">
                </div>
                {% endif %}
        <div class="text" style="word-break:break-word">
            {{ article.text|safe }}
        </div>
        <div class="second_level">
            <div class="readings">
                üëÅ{{ article.readings }}
            </div>
            <div class="article_mark">
                {% if article.mark > 0 %}
                <div title="–û—Ü–µ–Ω–∫–∞" style="color:#00ff00;">
                    <strong>
                        +{{article.mark}}
                    </strong>
                </div>
                {% elif article.mark == 0 %}
                <div title="–û—Ü–µ–Ω–∫–∞" style="color:white;">
                    <strong>
                        {{article.mark}}
                    </strong>
                </div>
                {% else %}
                <div title="–û—Ü–µ–Ω–∫–∞" style="color: red;">
                    <strong>
                        {{article.mark}}
                    </strong>
                </div>
                {% endif %}
        </div>
        <div class="make_mark">
            <button class="btn btn-outline-danger" name="mark" value="-1">-1</button>
            <button class="btn btn-outline-success" name="mark" value="1">+1</button>
        </div>
        </div>
        </div>
    <div class="comments">
        <div style=" margin-top:15px">
            <h1>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ amount_comments }})</h1>
        </div>
        <div class="make_comment">
            {% if current_user.is_authenticated %}
            <div class="comment_form" style="width: 80%;margin-top:10px">
                {{ comment_form.text(class="form-control", style=' background-color: #343F52; color:white ') }}<br>
                {% for error in comment_form.text.errors %}
                    <div class="alert alert-danger" role="alert">
                        {{ error }}
                    </div>
                {% endfor %}
            </div>
            <button class="btn btn-primary" name="comment" value="1">–°–æ–∑–¥–∞—Ç—å</button>
            {% else %}
            <div style="color:white;font-size:50px">
                –ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
            </div>
            {% endif %}
        </div>
        <div style="padding-bottom:10px" class="all_comments">
            {% for comment in all_comments %}
            {% if not comment.answer_on %}
            <div class="comment">
                <a style="display:flex; text-decoration: none;" href="/profile/{{comment.user}}">
                    <div class="image">
                        <img src="/static/images/{{creators_comments[comment.id|string][1]}}" height="30px" width="30px" style="margin-top:20px;border-radius: 50%">
                    </div>
                    {% if comment.user|string == user.id|string %}
                    <div class="creator_name" style="color:white;margin-top:22px;margin-left:10px; background-color: gray; border-radius: 10px;padding-left:5px;padding-right:5px;margin-bottom:10px"> {{ creators_comments[comment.id|string][0] }}</div>
                    {% else %}
                    <div class="creator_name" style="color:white;margin-top:22px;margin-left:10px"> {{ creators_comments[comment.id|string][0] }}</div>
                    {% endif %}
                </a>
                <div class="text" style="margin-top:10px;margin-bottom:10px;word-break:break-word">{{comment.text|safe}}</div>

                {% if comment.mark > 0 %}
                    <div title="–û—Ü–µ–Ω–∫–∞" style="color:#00ff00; float: right">
                        <strong>+{{comment.mark}}</strong>
                    </div>
                    {% elif comment.mark == 0 %}
                    <div title="–û—Ü–µ–Ω–∫–∞" style="color:white; float: right">
                        <strong>{{comment.mark}}</strong>
                    </div>
                    {% else %}
                    <div title="–û—Ü–µ–Ω–∫–∞" style="color: red; float: right">
                        <strong>{{comment.mark}}</strong>
                    </div>
            {% endif %}
                <button name="comment_mark" class="btn btn-outline-danger" value="{{ comment.id }},-1">-1</button>
                <button name="comment_mark" class="btn btn-outline-success"  value="{{ comment.id }},1">+1</button>
                {% if to_answer == comment.id|string %}
                    <textarea name="answer_input" class="comment_form"  style=' background-color: #343F52; color:white ;width:100%;margin-top:20px;margin-bottom:5px'></textarea>
                    <button name="make_answer" class="btn btn-outline-primary" value="{{ comment.id }}">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                {% else %}
                <button name="to_answer" class="btn btn-outline-primary" value="{{ comment.id }}">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                {% endif %}
                {% for answer in answers_comments[comment.id|string] %}
                    <div class="answer">
                        <a style="display:flex; text-decoration: none;" href="/profile/{{answer.user}}">
                    <div class="image">
                        <img src="/static/images/{{creators_comments[answer.id|string][1]}}" height="30px" width="30px" style="margin-top:20px; border-radius:50%">
                    </div>
                            {% if answer.user|string == user.id|string %}
                    <div class="creator_name" style="color:white;margin-top:22px;margin-left:10px; background-color: gray; border-radius: 10px;padding-left:5px;padding-right:5px;margin-bottom:10px"> {{ creators_comments[answer.id|string][0] }}</div>
                    {% else %}
                    <div class="creator_name" style="color:white;margin-top:22px;margin-left:10px"> {{ creators_comments[answer.id|string][0] }}</div>
                    {% endif %}
                        </a>
                            <div class="text" style="margin-top:10px;margin-bottom:10px;word-break:break-word">{{answer.text|safe}}</div>

                    {% if answer.mark > 0 %}
                        <div title="–û—Ü–µ–Ω–∫–∞" style="color:#00ff00; float: right">
                            <strong>+{{answer.mark}}</strong>
                        </div>
                        {% elif answer.mark == 0 %}
                        <div title="–û—Ü–µ–Ω–∫–∞" style="color:white; float: right">
                            <strong>{{answer.mark}}</strong>
                        </div>
                        {% else %}
                        <div title="–û—Ü–µ–Ω–∫–∞" style="color: red; float: right">
                            <strong>{{answer.mark}}</strong>
                        </div>
                {% endif %}
                    <button name="comment_mark" class="btn btn-outline-danger" value="{{ answer.id }},-1">-1</button>
                    <button name="comment_mark" class="btn btn-outline-success"  value="{{ answer.id }},1">+1</button>
                        <br>
                        </div>
                {% endfor %}

            </div>
            {% endif %}
            {% endfor %}
        </div>

    </div>


</form>
{% endblock %}

